import{r as i,d as N,u as M,e as P,a as l,c as a,b as s,t as r,w as k,v as R,f as $,g as w,n as T,F as V,h as B,i as z,j as D}from"./index-Cy4swcOJ.js";import{a as p}from"./axios-BimPEqV4.js";const S="/vue-project-todos/empty.png",j={id:"todoListPage",class:"bg-half"},E={class:"todo_sm"},F={href:"#"},q={class:"conatiner todoListPage vhContainer"},A={class:"todoList_Content"},G={class:"inputBox"},H={key:0},J={key:1,class:"todoList_list"},K={class:"todoList_tab"},Q={class:"todoList_items"},W={key:0},X={class:"todoList_label"},Y=["onUpdate:modelValue","onChange"],Z=["onClick"],tt={key:1},st={class:"todoList_label"},ot=["onUpdate:modelValue","onChange"],et=["onClick"],lt={key:2,class:"todoList_item"},at={class:"todoList_label"},nt=["onUpdate:modelValue","onChange"],it=["onClick"],ut={class:"todoList_statistics"},ct={key:0},dt={key:1},vt={__name:"ToDoListView",setup(rt){const u=document.cookie.replace(/(?:(?:^|.*;\s*)cookieName\s*\=\s*([^;]*).*$)|^.*$/,"$1"),U=i("");N(async()=>{if(!u)alert("沒有登入權限"),x.push("/");else try{const o=await p.get("https://todolist-api.hexschool.io/users/checkout",{headers:{authorization:u}});U.value=o.data.nickname,console.log(o)}catch(o){alert(o.response.data.message),setInterval(()=>{x.push("/")},3e3),console.log(o)}});const _=i({content:""}),I=async()=>{try{const o=await p.post("https://todolist-api.hexschool.io/todos/",_.value,{headers:{authorization:u}});g(),_.value.content="",console.log(o)}catch(o){alert(o.response.data.message),console.log(o)}},c=i([]),y=i([]),L=i([]);N(()=>{g()});const g=async()=>{try{const o=await p.get("https://todolist-api.hexschool.io/todos/",{headers:{authorization:u}});c.value=o.data.data,y.value=c.value.filter(t=>t.status===!1),L.value=c.value.filter(t=>t.status===!0),console.log(o)}catch(o){alert(o.response.data.message),console.log(o)}},m=async o=>{try{const t=await p.delete(`https://todolist-api.hexschool.io/todos/${o}`,{headers:{authorization:u}});c.value=c.value.filter(v=>v.id!==o),g(),console.log(t)}catch(t){alert(t.response.data.message),console.log(t)}},b=async o=>{try{const t=await p.patch(`https://todolist-api.hexschool.io/todos/${o}/toggle`,{},{headers:{authorization:u}});g(),console.log(t)}catch(t){alert(t.response.data.message),console.log(t)}},f=i(!0),h=i(!1),d=i(!1);function C(o){o==="all"?(f.value=!0,h.value=!1,d.value=!1):o==="prepare"?(f.value=!1,h.value=!0,d.value=!1):o==="finish"&&(f.value=!1,h.value=!1,d.value=!0)}const x=M(),O=async()=>{try{const o=await p.post("https://todolist-api.hexschool.io/users/sign_out",{},{headers:{authorization:u}});alert("登出成功"),x.replace("/"),console.log(o)}catch(o){alert(o.response.data.message),console.log(o)}};return(o,t)=>{const v=P("RouterLink");return l(),a("div",j,[s("nav",null,[t[4]||(t[4]=s("h1",null,[s("a",{href:"#"},"ONLINE TODO LIST")],-1)),s("ul",null,[s("li",E,[s("a",F,[s("span",null,r(U.value)+"的代辦",1)])]),s("li",null,[s("button",{type:"button",class:"noBackgorund",onClick:O},"登出")])])]),s("div",q,[s("div",A,[s("div",G,[k(s("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":t[0]||(t[0]=e=>_.value.content=e)},null,512),[[R,_.value.content]]),s("button",{type:"button",onClick:I},t[5]||(t[5]=[s("i",{class:"fa fa-plus"},null,-1)]))]),c.value.length===0?(l(),a("div",H,t[6]||(t[6]=[s("p",{class:"empty"},"目前尚無待辦事項",-1),s("img",{class:"",width:"240",src:S,alt:"workImg"},null,-1)]))):(l(),a("div",J,[s("ul",K,[s("li",null,[$(v,{to:"/ToDoList",class:T(f.value?"active":""),onClick:t[1]||(t[1]=e=>C("all"))},{default:w(()=>t[7]||(t[7]=[z("全部")])),_:1},8,["class"])]),s("li",null,[$(v,{to:"/ToDoList/prepare",class:T(h.value?"active":""),onClick:t[2]||(t[2]=e=>C("prepare"))},{default:w(()=>t[8]||(t[8]=[z("待完成")])),_:1},8,["class"])]),s("li",null,[$(v,{to:"/ToDoList/finish",class:T(d.value?"active":""),onClick:t[3]||(t[3]=e=>C("finish"))},{default:w(()=>t[9]||(t[9]=[z("已完成")])),_:1},8,["class"])])]),s("div",Q,[h.value?(l(),a("ul",W,[(l(!0),a(V,null,B(y.value,e=>(l(),a("li",{key:e.id},[s("label",X,[k(s("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":n=>e.status=n,onChange:n=>b(e.id)},null,40,Y),[[D,e.status]]),s("span",null,r(e.content),1)]),s("button",{type:"button",class:"noBackgorund",onClick:n=>m(e.id)},t[10]||(t[10]=[s("i",{class:"fa fa-times"},null,-1)]),8,Z)]))),128))])):d.value?(l(),a("ul",tt,[(l(!0),a(V,null,B(L.value,e=>(l(),a("li",{key:e.id},[s("label",st,[k(s("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":n=>e.status=n,onChange:n=>b(e.id)},null,40,ot),[[D,e.status]]),s("span",null,r(e.content),1)]),s("button",{type:"button",class:"noBackgorund",onClick:n=>m(e.id)},t[11]||(t[11]=[s("i",{class:"fa fa-times"},null,-1)]),8,et)]))),128))])):(l(),a("ul",lt,[(l(!0),a(V,null,B(c.value,e=>(l(),a("li",{key:e.id},[s("label",at,[k(s("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":n=>e.status=n,onChange:n=>b(e.id)},null,40,nt),[[D,e.status]]),s("span",null,r(e.content),1)]),s("button",{type:"button",class:"noBackgorund",onClick:n=>m(e.id)},t[12]||(t[12]=[s("i",{class:"fa fa-times"},null,-1)]),8,it)]))),128))])),s("div",ut,[d.value?(l(),a("p",ct,r(L.value.length)+" 個已完成項目",1)):(l(),a("p",dt,r(y.value.length)+" 個待完成項目",1))])])]))])])])}}};export{vt as default};
